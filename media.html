<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>911 Experience â€” Audio & Video</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;600&family=Teko:wght@500;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#000; --panel:#0b0b0b; --line:rgba(255,255,255,.08);
  --txt:#fff; --muted:rgba(255,255,255,.78); --gold:#d4af37;
}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:Sora,system-ui;background:var(--bg);color:var(--txt);overflow-x:hidden}

/* Header (dropdown) */
header.nav{
  position:fixed; top:0; left:0; right:0; z-index:20;
  display:flex; align-items:center; justify-content:space-between;
  padding:16px 22px;
  background:linear-gradient(180deg, rgba(0,0,0,.55), rgba(0,0,0,0));
  border-bottom:1px solid var(--line);
  transition:transform .35s ease;
}
header.nav.hide{ transform:translateY(-100%) }
.brand{ font-family:Teko; font-weight:700; text-transform:uppercase; letter-spacing:.06em }
nav.nav{ display:flex; gap:1.5rem }
nav.nav a{ color:#fff; text-decoration:none; opacity:.92; font-weight:600; white-space:nowrap }
nav.nav a:hover{ opacity:1; border-bottom:2px solid var(--gold); padding-bottom:2px }
.menu-toggle{ display:none; background:transparent; border:0; cursor:pointer }
.menu-toggle span{ height:3px; width:26px; background:#fff; display:block; border-radius:3px }
@media (max-width:820px){
  .menu-toggle{ display:flex; flex-direction:column; gap:6px; width:34px; height:28px }
  nav.nav{
    position:fixed; top:64px; right:0; flex-direction:column; gap:0;
    background:rgba(0,0,0,.95); padding:12px 18px; border-left:1px solid var(--line);
    backdrop-filter:blur(6px); transform:translateX(100%); transition:transform .28s ease }
  nav.nav.open{ transform:translateX(0) }
}
.page-offset{ padding-top:76px }

/* Hero */
.hero{
  width:min(1200px,92%); margin:0 auto 32px; padding:18px 0 2px;
  border-bottom:1px solid var(--line);
}
.hero .eyebrow{ font-family:Teko; letter-spacing:.30em; text-transform:uppercase; color:var(--muted); font-size:.9rem }
.hero h1{ font-family:Teko; text-transform:uppercase; letter-spacing:.05em; font-size:clamp(1.9rem,4.5vw,3rem); margin:.3rem 0 .5rem }
.hero p{ color:var(--muted); max-width:62ch }

/* Section shell */
.wrap{ width:min(1200px,92%); margin:18px auto 64px }

/* Buttons */
.btn{ appearance:none; border:1px solid var(--line); background:#111; color:#fff; padding:.6rem .9rem; border-radius:999px; cursor:pointer; font-weight:600 }
.btn:hover{ border-color:rgba(255,255,255,.2) }
.btn-row{ display:flex; gap:10px; flex-wrap:wrap; align-items:center }

/* Audio grid */
.audio-grid{ display:grid; gap:14px; grid-template-columns:repeat(auto-fit, minmax(220px, 1fr)) }
.card{ position:relative; background:var(--panel); border:1px solid var(--line); border-radius:14px; overflow:hidden }
.card.pad{ padding:14px 14px 12px }
.card h3{ font-family:Teko; letter-spacing:.03em; text-transform:uppercase; color:var(--gold); font-size:1.1rem }
.card p{ color:var(--muted); font-size:.95rem; margin-top:2px }
.audio-tile{ display:grid; gap:10px; align-content:start; cursor:pointer }
.audio-bar{ display:flex; gap:3px; height:16px; align-items:flex-end; margin-top:4px }
.audio-bar span{ width:3px; height:6px; background:rgba(255,255,255,.35); border-radius:2px; transition:height .15s linear, background .15s linear }
.audio-tile.playing .audio-bar span{ background:var(--gold) }
.audio-tile.playing .audio-bar span:nth-child(odd){ height:16px; animation:wave .6s ease-in-out infinite }
.audio-tile.playing .audio-bar span:nth-child(even){ height:12px; animation:wave .6s ease-in-out .2s infinite }
@keyframes wave{ 0%,100%{transform:scaleY(.7)} 50%{transform:scaleY(1)} }

/* Videos */
.video-grid{ display:grid; gap:16px; grid-template-columns:repeat(auto-fit, minmax(280px, 1fr)) }
.vcard{
  position:relative; border:1px solid var(--line); border-radius:16px; overflow:hidden; background:#111;
  transition: box-shadow .3s ease, border-color .3s ease, filter .3s ease;
}
.vcard.playing{ border-color:rgba(212,175,55,.65); box-shadow:0 0 0 2px rgba(212,175,55,.25), 0 12px 40px rgba(0,0,0,.45) }
.vmeta{ position:absolute; left:12px; bottom:10px; right:12px; display:flex; justify-content:space-between; align-items:end; color:#fff; text-shadow:0 2px 10px rgba(0,0,0,.8) }
.vtitle{ font-family:Teko; text-transform:uppercase; letter-spacing:.04em; font-size:1.05rem }
.badge{ background:rgba(0,0,0,.6); border:1px solid var(--line); padding:.2rem .5rem; border-radius:6px; color:var(--gold); font-weight:700 }
video{ width:100%; height:100%; display:block; object-fit:cover;
  background: radial-gradient(90% 60% at 70% 20%, rgba(212,175,55,.08), transparent 60%),
             linear-gradient(180deg, rgba(0,0,0,.2), rgba(0,0,0,.7));
}

/* per-video volume button */
.vcontrols{
  position:absolute; top:10px; right:10px; display:flex; gap:8px; z-index:2;
}
.iconbtn{
  width:36px; height:36px; display:grid; place-items:center; border-radius:999px;
  background:rgba(0,0,0,.55); border:1px solid var(--line); color:#fff; cursor:pointer;
}
.iconbtn:hover{ background:rgba(0,0,0,.7) }
.icon{ font-size:18px; line-height:1 }
</style>
</head>
<body>
<header class="nav" role="navigation" aria-label="Primary">
  <div class="brand">The 911 Experience</div>

  <button class="menu-toggle" id="menuToggle" aria-label="Menu" aria-controls="mainNav" aria-expanded="false">
    <span></span><span></span><span></span>
  </button>

  <nav class="nav" id="mainNav">
    <a href="index.html">Home</a>
    <a href="gallery.html">Gallery</a>
    <a href="media.html" aria-current="page">Audio & Video</a>
    <a href="specs.html">Specs</a>
  </nav>
</header>

<div class="page-offset">
  <!-- Hero -->
  <section class="hero">
    <p class="eyebrow">Porsche 911 Series</p>
    <h1>Feel the Mechanics</h1>
    <p>Listen to the flat-six breathe â€” and watch the 911 in motion. Sounds loop on tap; videos auto-play when in view and pause when theyâ€™re not.</p>
  </section>

  <!-- Audio -->
  <section class="wrap" aria-labelledby="audioLibTitle">
    <div style="display:flex;justify-content:space-between;align-items:end;gap:10px;margin-bottom:10px">
      <h2 id="audioLibTitle" class="eyebrow">Engine Sound Library</h2>
      <div class="btn-row"><button class="btn" id="stopAll">Stop All</button></div>
    </div>
    <div class="audio-grid">
      <article class="card pad audio-tile" data-src="assets/media/audio/Straight-cutting-gears.mp3">
        <h3>Straight-Cutting Gears</h3>
        <p>Raw mechanical whine.</p>
        <div class="audio-bar" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span></div>
      </article>
      <article class="card pad audio-tile" data-src="assets/media/audio/pops-bangs.mp3">
        <h3>Pops & Bangs</h3>
        <p>Overrun crackles.</p>
        <div class="audio-bar" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span></div>
      </article>
      <article class="card pad audio-tile" data-src="assets/media/audio/speed-sound.mp3">
        <h3>Speed Pull</h3>
        <p>Short pull to redline.</p>
        <div class="audio-bar" aria-hidden="true"><span></span><span></span><span></span><span></span><span></span><span></span></div>
      </article>
    </div>
  </section>

  <!-- Videos -->
  <section class="wrap" aria-labelledby="videoTitle">
    <div style="display:flex;justify-content:space-between;align-items:end;gap:10px;margin-bottom:10px">
      <h2 id="videoTitle" class="eyebrow">In Motion</h2>
      <div class="btn-row">
        <button class="btn" id="playAll">Play All</button>
        <button class="btn" id="pauseAll">Pause All</button>
        <button class="btn" id="muteAll">Mute All</button>
      </div>
    </div>

    <div class="video-grid">
      <article class="vcard">
        <div class="vcontrols">
          <button class="iconbtn muteBtn" aria-label="Toggle sound"><span class="icon">ðŸ”‡</span></button>
        </div>
        <video class="autoVideo" muted playsinline webkit-playsinline preload="auto" loop
               src="assets/media/video/gt3-horse.mp4"></video>
        <div class="vmeta">
          <div class="vtitle">GT3 RS â€” Flyby</div>
          <div class="badge">Auto-Play</div>
        </div>
      </article>

      <article class="vcard">
        <div class="vcontrols">
          <button class="iconbtn muteBtn" aria-label="Toggle sound"><span class="icon">ðŸ”‡</span></button>
        </div>
        <video class="autoVideo" muted playsinline webkit-playsinline preload="auto" loop
               src="assets/media/video/gt3-edit.mp4"></video>
        <div class="vmeta">
          <div class="vtitle">GT3 RS â€” Track Symphony</div>
          <div class="badge">Auto-Play</div>
        </div>
      </article>
    </div>
  </section>
</div>

<script>
/* auto-hide header */
let lastScroll=0;
const nav=document.querySelector("header.nav");
window.addEventListener("scroll",()=>{
  const y=window.pageYOffset||document.documentElement.scrollTop;
  if(y>lastScroll && y>100) nav.classList.add("hide"); else nav.classList.remove("hide");
  lastScroll = y <= 0 ? 0 : y;
});

/* mobile menu */
const menuToggle=document.getElementById("menuToggle");
const mainNav=document.getElementById("mainNav");
menuToggle?.addEventListener("click",()=>{
  const open=mainNav.classList.toggle("open");
  menuToggle.setAttribute("aria-expanded", open ? "true" : "false");
});

/* ===== Audio tiles ===== */
const tiles = document.querySelectorAll('.audio-tile');
const audios = new Map();
tiles.forEach(tile=>{
  const audio = new Audio(tile.dataset.src);
  audio.preload='auto'; audio.loop=true; audios.set(tile,audio);
  const play = async ()=>{ audios.forEach((a,t)=>{ if(t!==tile){ a.pause(); t.classList.remove('playing'); }});
                           audio.currentTime=0; tile.classList.add('playing'); try{ await audio.play(); }catch{} }
  const stop = ()=>{ audio.pause(); tile.classList.remove('playing'); };
  tile.addEventListener('click', ()=> audio.paused ? play() : stop() );
});
document.getElementById('stopAll').addEventListener('click', ()=> audios.forEach((a,t)=>{ a.pause(); t.classList.remove('playing'); }));

/* ===== Videos: autoplay on view, pause off view + gold glow while playing ===== */
const cards=[...document.querySelectorAll('.vcard')];
const vids=[...document.querySelectorAll('.autoVideo')];
const muteBtns=[...document.querySelectorAll('.muteBtn')];

function tryPlay(v){ v.muted=true; v.play().catch(()=>{}); }

const io=new IntersectionObserver(entries=>{
  entries.forEach(e=>{
    const v=e.target, card=v.closest('.vcard');
    if(e.isIntersecting && e.intersectionRatio>=0.6){ tryPlay(v); card?.classList.add('playing'); }
    else{ v.pause(); card?.classList.remove('playing'); }
  });
},{threshold:[0,0.6,1]});

vids.forEach(v=>{
  io.observe(v);
  v.addEventListener('loadeddata', ()=>tryPlay(v), {once:true});
  window.addEventListener('load', ()=>tryPlay(v));
});

/* per-video mute toggle (tap to hear that one video) */
muteBtns.forEach((btn, i)=>{
  const v = vids[i];
  btn.addEventListener('click', ()=>{
    const newMuted = !v.muted;
    // mute all others when unmuting one (so it stands out)
    if(!newMuted){ vids.forEach((ov,j)=>{ if(j!==i){ ov.muted=true; muteBtns[j].querySelector('.icon').textContent='ðŸ”‡'; } }); }
    v.muted = newMuted;
    btn.querySelector('.icon').textContent = v.muted ? 'ðŸ”‡' : 'ðŸ”Š';
    if(v.paused) tryPlay(v);
  });
});

/* Global controls */
document.getElementById('playAll').addEventListener('click', ()=> vids.forEach(v=>tryPlay(v)));
document.getElementById('pauseAll').addEventListener('click', ()=> vids.forEach(v=>v.pause()));
document.getElementById('muteAll').addEventListener('click', ()=>{
  vids.forEach((v,i)=>{ v.muted=true; muteBtns[i].querySelector('.icon').textContent='ðŸ”‡'; });
});

/* iOS extra nudges */
['touchstart','pointerdown','click','keydown','visibilitychange'].forEach(evt=>{
  document.addEventListener(evt, ()=> vids.forEach(v=>{ if(v.paused) tryPlay(v); }), {passive:true});
});
</script>
</body>
</html>
