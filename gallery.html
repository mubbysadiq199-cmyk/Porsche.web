<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>911 Collections — Gallery</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;600&family=Teko:wght@400;600;700&display=swap" rel="stylesheet">

<!-- Preload the first image of each collection for instant first paint -->
<link rel="preload" as="image" href="assets/gallery/black-911/black-911-01.jpg">
<link rel="preload" as="image" href="assets/gallery/white-911/white-911-01.jpg">

<style>
  /* Header */
  header.nav{
    position:fixed; top:0; left:0; right:0; z-index:10;
    display:flex; align-items:center; justify-content:space-between;
    padding:16px 22px;
    background:linear-gradient(180deg, rgba(0,0,0,.55), rgba(0,0,0,0));
    border-bottom:1px solid rgba(255,255,255,.06);
  }
  .brand{
    font-family:"Teko",system-ui; font-weight:700; text-transform:uppercase;
    letter-spacing:.06em; opacity:.95; white-space:nowrap; font-size:1.05rem;
  }
  nav.nav{ display:flex; gap:1.5rem; }
  nav.nav a{ color:#fff; text-decoration:none; opacity:.9; font-size:.95rem; font-weight:500; }
  nav.nav a:hover{ opacity:1; border-bottom:2px solid #d4af37; padding-bottom:2px; }
  .menu-toggle{ display:none; background:transparent; border:0; cursor:pointer; }
  .menu-toggle span{ height:3px; width:26px; background:#fff; display:block; border-radius:3px; }
  @media (max-width:640px){
    .menu-toggle{ display:flex; flex-direction:column; gap:6px; width:34px; height:28px; }
    nav.nav{
      position:fixed; top:64px; right:0;
      flex-direction:column; gap:0;
      background:rgba(0,0,0,.92); padding:12px 18px;
      border-left:1px solid rgba(255,255,255,.1); backdrop-filter:blur(6px);
      transform:translateX(100%); transition:transform .28s ease;
    }
    nav.nav.open{ transform:translateX(0); }
  }
  .page-offset{ padding-top:76px; }

  :root{ --bg:#000; --txt:#fff; --gold:#d4af37; --muted:rgba(255,255,255,.7) }
  *{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--txt);font-family:Sora,system-ui}
  h1,h2,h3{font-family:Teko,system-ui;text-transform:uppercase;letter-spacing:.04em}

  .wrap{width:min(1100px,92%);margin:28px auto}
  .muted{opacity:.75}

  /* ===== Cover grid (collection chooser) ===== */
  .cover-grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
    gap:20px;
    margin:12px 0 36px;
  }
  .cover{
    position:relative; display:block; aspect-ratio:16/9;
    border-radius:16px; overflow:hidden;
    background:#0b0b0b center/cover no-repeat;
    border:1px solid rgba(255,255,255,.08);
    transition:transform .3s ease, filter .3s ease;
  }
  .cover:hover{ transform:scale(1.03); filter:brightness(1.08); }
  .cover::after{
    content:""; position:absolute; inset:0; pointer-events:none;
    background:linear-gradient(180deg, rgba(0,0,0,.25), rgba(0,0,0,.65));
  }
  .cover .overlay{
    position:absolute; inset:0; display:grid; place-items:end start;
    padding:14px;
  }
  .cover h3{ margin:0; font-size:1.6rem; }

  /* ===== Slideshows ===== */
  .head{display:flex; align-items:end; justify-content:space-between; gap:12px; flex-wrap:wrap}

  .slideshow{
    position:relative; aspect-ratio:16/9; background:#0b0b0b; border-radius:16px; overflow:hidden;
    border:1px solid rgba(255,255,255,.08);
  }
  .slide{
    position:absolute; inset:0; background:#000 center/cover no-repeat; opacity:0;
    transform:translateY(0) scale(1.02);
    will-change:opacity, transform;
    transition:opacity 900ms cubic-bezier(.22,.61,.36,1), transform 4800ms cubic-bezier(.22,.61,.36,1);
    filter:brightness(.92);
  }
  .slide.is-active{ opacity:1; transform:translateY(0) scale(1.0) }
  .slide.is-out{
    opacity:0; transform:translateY(-12px) scale(1.03);
    transition:opacity 900ms cubic-bezier(.22,.61,.36,1), transform 1200ms cubic-bezier(.22,.61,.36,1);
  }
  .slideshow::after{
    content:""; position:absolute; inset:0; pointer-events:none;
    background:radial-gradient(120% 80% at 50% 100%, rgba(0,0,0,.65) 0%, rgba(0,0,0,.2) 35%, rgba(0,0,0,.5) 90%),
               linear-gradient(180deg, rgba(0,0,0,.25), rgba(0,0,0,.75));
  }

  .ctrl{
    position:absolute; top:50%; translate:0 -50%;
    width:42px; height:42px; border-radius:999px; border:1px solid rgba(255,255,255,.2);
    background:rgba(0,0,0,.4); color:#fff; display:grid; place-items:center; cursor:pointer;
    transition:transform .15s ease, background .2s ease, opacity .2s ease;
    z-index:3; backdrop-filter:blur(4px);
  }
  .ctrl:hover{ transform:scale(1.05); background:rgba(0,0,0,.55) }
  .prev{ left:10px } .next{ right:10px }

  .dots{ position:absolute; left:50%; bottom:10px; translate:-50% 0; display:flex; gap:8px; z-index:3 }
  .dot{ width:8px; height:8px; border-radius:50%; background:rgba(255,255,255,.35); border:0; cursor:pointer; }
  .dot.is-active{ background:var(--gold) }

  .cap{ margin:8px 2px 0; font-size:.95rem; color:var(--muted) }

  @media(max-width:540px){ .slideshow{ aspect-ratio:9/16 } }
  @media (prefers-reduced-motion: reduce){ .slide, .slide.is-out{ transition:none; transform:none } }
  html{ scroll-behavior:smooth; }
</style>
</head>
<body>
  <!-- Header -->
  <header class="nav" role="navigation" aria-label="Primary">
    <div class="brand">The 911 Experience</div>
    <button class="menu-toggle" id="menuToggle" aria-label="Menu" aria-controls="mainNav" aria-expanded="false">
      <span></span><span></span><span></span>
    </button>
    <nav class="nav" id="mainNav">
      <a href="index.html">Home</a>
      <a href="gallery.html" aria-current="page">Gallery</a>
      <a href="media.html">Audio & Video</a>
      <a href="specs.html">Specs</a>
    </nav>
  </header>

  <div class="page-offset">
    <div class="wrap">
      <h1>911 Collections</h1>

      <!-- ===== Cover Grid (jump to each collection) ===== -->
      <section class="cover-grid" aria-label="Collections overview">
        <a href="#black911" class="cover" style="background-image:url('assets/gallery/black-911/black-911-01.jpg')">
        </a>
        <a href="#white911" class="cover" style="background-image:url('assets/gallery/white-911/white-911-01.jpg')">
        </a>
      </section>

      <!-- ===== Black 911 ===== -->
      <section id="black911" class="collection"
        data-folder="assets/gallery/black-911"
        data-prefix="black-911-"
        data-count="7"
        data-ext="jpg">
        <div class="head"><h2>Black Porsche 911 Collection</h2></div>
        <div class="slideshow">
          <button class="ctrl prev" aria-label="Previous">&#10094;</button>
          <button class="ctrl next" aria-label="Next">&#10095;</button>
          <div class="dots" aria-label="Pagination"></div>
        </div>
        <p class="cap">Every curve tells a story of velocity; built to dominate both night and track.</p>
      </section>

      <!-- ===== White 911 ===== -->
      <section id="white911" class="collection"
        data-folder="assets/gallery/white-911"
        data-prefix="white-911-"
        data-count="5"
        data-ext="jpg">
        <div class="head"><h2>White Porsche 911 Collection</h2></div>
        <div class="slideshow">
          <button class="ctrl prev" aria-label="Previous">&#10094;</button>
          <button class="ctrl next" aria-label="Next">&#10095;</button>
          <div class="dots" aria-label="Pagination"></div>
        </div>
        <p class="cap">Purity in motion — the white 911 embodies precision, balance, and the calm before speed.</p>
      </section>
    </div>
  </div>

  <!-- ===== Slideshow builder ===== -->
  <script>
  function buildCarousel(section){
    const folder = section.dataset.folder;
    const prefix = section.dataset.prefix;
    const ext    = section.dataset.ext || 'jpg';
    const count  = parseInt(section.dataset.count, 10);

    const shell  = section.querySelector('.slideshow');
    const dotsEl = shell.querySelector('.dots');
    const prev   = shell.querySelector('.prev');
    const next   = shell.querySelector('.next');

    const slides = [];
    for(let i=1;i<=count;i++){
      const n = String(i).padStart(2,'0');
      const src = `${folder}/${prefix}${n}.${ext}`;

      const s = document.createElement('div');
      s.className = 'slide';
      s.dataset.src = src;    // lazy
      shell.appendChild(s);
      slides.push(s);

      const d = document.createElement('button');
      d.className = 'dot';
      d.setAttribute('aria-label', `Go to slide ${i}`);
      dotsEl.appendChild(d);
    }

    // Lazy-load once visible
    const io = new IntersectionObserver((entries)=>{
      entries.forEach(e=>{
        if(e.isIntersecting){
          slides.forEach(sl=>{
            if(!sl.style.backgroundImage && sl.dataset.src){
              const img = new Image();
              img.onload = ()=> { sl.style.backgroundImage = `url('${sl.dataset.src}')`; };
              img.src = sl.dataset.src;
            }
          });
          io.disconnect();
        }
      });
    }, { rootMargin:'200px' });
    io.observe(shell);

    let idx = 0, timer = null;
    const DURATION = 6000, FADE = 900;

    function setActive(newIdx){
      if(newIdx === idx) return;
      const cur = slides[idx];
      const nxt = slides[newIdx];
      cur.classList.remove('is-active'); cur.classList.add('is-out');
      nxt.classList.add('is-active');    nxt.classList.remove('is-out');

      dotsEl.querySelectorAll('.dot').forEach((d,i)=> d.classList.toggle('is-active', i===newIdx));
      setTimeout(()=> cur.classList.remove('is-out'), FADE+50);
      idx = newIdx;
    }
    function go(delta){ setActive((idx + delta + slides.length) % slides.length); restart(); }
    function autoplay(){ timer = setInterval(()=> go(1), DURATION); }
    function restart(){ clearInterval(timer); autoplay(); }

    // Init
    slides[0].classList.add('is-active');
    dotsEl.querySelectorAll('.dot')[0]?.classList.add('is-active');
    autoplay();

    // Controls
    prev.addEventListener('click', ()=> go(-1));
    next.addEventListener('click', ()=> go(1));
    dotsEl.addEventListener('click', e=>{
      if(e.target.classList.contains('dot')){
        const i = Array.from(dotsEl.children).indexOf(e.target);
        setActive(i); restart();
      }
    });

    // Swipe
    let sx=0, sy=0;
    shell.addEventListener('touchstart', e=>{ sx=e.touches[0].clientX; sy=e.touches[0].clientY; }, {passive:true});
    shell.addEventListener('touchend', e=>{
      const dx = e.changedTouches[0].clientX - sx;
      const dy = e.changedTouches[0].clientY - sy;
      if(Math.abs(dx) > Math.abs(dy) && Math.abs(dx) > 40){ go(dx>0 ? -1 : 1); }
    }, {passive:true});

    // Pause on hover (desktop)
    shell.addEventListener('mouseenter', ()=> clearInterval(timer));
    shell.addEventListener('mouseleave', ()=> restart());

    // Keyboard (accessibility)
    section.addEventListener('keydown', e=>{
      if(e.key === 'ArrowLeft') go(-1);
      if(e.key === 'ArrowRight') go(1);
    });
    section.tabIndex = 0; // focusable for arrow keys
  }

  // Build all carousels
  document.querySelectorAll('.collection').forEach(buildCarousel);
  </script>

  <!-- Mobile menu -->
  <script>
    const menuToggle = document.getElementById('menuToggle');
    const mainNav = document.getElementById('mainNav');
    menuToggle?.addEventListener('click', ()=>{
      const open = mainNav.classList.toggle('open');
      menuToggle.setAttribute('aria-expanded', open ? 'true' : 'false');
    });
  </script>
</body>
</html>
